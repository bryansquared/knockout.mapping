// Knockout Mapping plugin v2.0.4
// (c) 2011 Steven Sanderson, Roy Jacobs - http://knockoutjs.com/
// License: MIT (http://www.opensource.org/licenses/mit-license.php)

ko.exportSymbol=function(j,s){for(var h=j.split("."),m=window,v=0;v<h.length-1;v++)m=m[h[v]];m[h[h.length-1]]=s};ko.exportProperty=function(j,s,h){j[s]=h};
(function(){function j(a,c){for(var b in c)c.hasOwnProperty(b)&&c[b]&&(b&&a[b]&&!(a[b]instanceof Array)?j(a[b],c[b]):a[b]=c[b])}function s(a,c){var b={};j(b,a);j(b,c);return b}function h(a,c){a=a||{};if(a.create instanceof Function||a.update instanceof Function||a.key instanceof Function||a.arrayChanged instanceof Function)a={"":a};c&&(a.ignore=m(c.ignore,a.ignore),a.include=m(c.include,a.include),a.copy=m(c.copy,a.copy));a.ignore=m(a.ignore,f.ignore);a.include=m(a.include,f.include);a.copy=m(a.copy,
f.copy);a.mappedProperties=a.mappedProperties||{};return a}function m(a,c){a instanceof Array||(a="undefined"===ko.mapping.getType(a)?[]:[a]);c instanceof Array||(c="undefined"===ko.mapping.getType(c)?[]:[c]);return a.concat(c)}function v(a,c){var b=ko.dependentObservable;ko.dependentObservable=function(b,c,d){var d=d||{},e=d.deferEvaluation;b&&"object"==typeof b&&(d=b);var k=!1,h=function(b){var c=p({read:function(){k||(ko.utils.arrayRemoveItem(a,b),k=!0);return b.apply(b,arguments)},write:function(a){return b(a)},
deferEvaluation:!0});c.__ko_proto__=p;return c};d.deferEvaluation=!0;b=new p(b,c,d);b.__ko_proto__=p;e||(a.push(b),b=h(b));return b};ko.computed=ko.dependentObservable;var d=c();ko.dependentObservable=b;ko.computed=ko.dependentObservable;return d}function z(a,c,b,d,g,h){var y=ko.utils.unwrapObservable(c)instanceof Array,h=h||"";if(ko.mapping.isMapped(a))var e=ko.utils.unwrapObservable(a)[n],b=s(e,b);var k=function(){return b[d]&&b[d].create instanceof Function},m=function(a){return v(C,function(){return b[d].create({data:a||
c,parent:g})})},l=function(){return b[d]&&b[d].update instanceof Function},f=function(a,J){var e={data:J||c,parent:g,target:ko.utils.unwrapObservable(a)};ko.isWriteableObservable(a)&&(e.observable=a);return b[d].update(e)};if(e=A.get(c))return e;d=d||"";if(y){var y=[],o=!1,i=function(a){return a};b[d]&&b[d].key&&(i=b[d].key,o=!0);ko.isObservable(a)||(a=ko.observableArray([]),a.mappedRemove=function(b){var c="function"==typeof b?b:function(a){return a===i(b)};return a.remove(function(a){return c(i(a))})},
a.mappedRemoveAll=function(b){var c=w(b,i);return a.remove(function(a){return-1!=ko.utils.arrayIndexOf(c,i(a))})},a.mappedDestroy=function(b){var c="function"==typeof b?b:function(a){return a===i(b)};return a.destroy(function(a){return c(i(a))})},a.mappedDestroyAll=function(b){var c=w(b,i);return a.destroy(function(a){return-1!=ko.utils.arrayIndexOf(c,i(a))})},a.mappedIndexOf=function(b){var c=w(a(),i),b=i(b);return ko.utils.arrayIndexOf(c,b)},a.mappedCreate=function(b){if(-1!==a.mappedIndexOf(b))throw Error("There already is an object with the key that you specified.");
var c=k()?m(b):b;l()&&(b=f(c,b),ko.isWriteableObservable(c)?c(b):c=b);a.push(c);return c});var e=w(ko.utils.unwrapObservable(a),i).sort(),j=w(c,i);o&&j.sort();for(var o=ko.utils.compareArrays(e,j),e={},j=[],p=0,u=o.length;p<u;p++){var t=o[p],q,r=h+"["+p+"]";switch(t.status){case "added":var x=B(ko.utils.unwrapObservable(c),t.value,i);q=z(void 0,x,b,d,a,r);k()||(q=ko.utils.unwrapObservable(q));r=F(ko.utils.unwrapObservable(c),x,e);j[r]=q;e[r]=!0;break;case "retained":x=B(ko.utils.unwrapObservable(c),
t.value,i);q=B(a,t.value,i);z(q,x,b,d,a,r);r=F(ko.utils.unwrapObservable(c),x,e);j[r]=q;e[r]=!0;break;case "deleted":q=B(a,t.value,i)}y.push({event:t.status,item:q})}a(j);b[d]&&b[d].arrayChanged&&ko.utils.arrayForEach(y,function(a){b[d].arrayChanged(a.event,a.item)})}else if(D(c)){a=ko.utils.unwrapObservable(a);if(!a){if(k())return o=m(),l()&&(o=f(o)),o;if(l())return f(o);a={}}l()&&(a=f(a));A.save(c,a);G(c,function(d){var e=h.length?h+"."+d:d;if(-1==ko.utils.arrayIndexOf(b.ignore,e))if(-1!=ko.utils.arrayIndexOf(b.copy,
e))a[d]=c[d];else{var g=A.get(c[d])||z(a[d],c[d],b,d,a,e);if(ko.isWriteableObservable(a[d]))a[d](ko.utils.unwrapObservable(g));else a[d]=g;b.mappedProperties[e]=!0}})}else switch(ko.mapping.getType(c)){case "function":l()?ko.isWriteableObservable(c)?(c(f(c)),a=c):a=f(c):a=c;break;default:ko.isWriteableObservable(a)?l()?a(f(a)):a(ko.utils.unwrapObservable(c)):(a=k()?m():ko.observable(ko.utils.unwrapObservable(c)),l()&&a(f(a)))}return a}function F(a,c,b){for(var d=0,g=a.length;d<g;d++)if(!0!==b[d]&&
a[d]===c)return d;return null}function H(a,c){var b;c&&(b=c(a));"undefined"===ko.mapping.getType(b)&&(b=a);return ko.utils.unwrapObservable(b)}function B(a,c,b){a=ko.utils.arrayFilter(ko.utils.unwrapObservable(a),function(a){return H(a,b)===c});if(0==a.length)throw Error("When calling ko.update*, the key '"+c+"' was not found!");if(1<a.length&&D(a[0]))throw Error("When calling ko.update*, the key '"+c+"' was not unique!");return a[0]}function w(a,c){return ko.utils.arrayMap(ko.utils.unwrapObservable(a),
function(a){return c?H(a,c):a})}function G(a,c){if(a instanceof Array)for(var b=0;b<a.length;b++)c(b);else for(b in a)c(b)}function D(a){var c=ko.mapping.getType(a);return"object"===c&&null!==a&&"undefined"!==c}function I(){var a=[],c=[];this.save=function(b,d){var g=ko.utils.arrayIndexOf(a,b);0<=g?c[g]=d:(a.push(b),c.push(d))};this.get=function(b){b=ko.utils.arrayIndexOf(a,b);return 0<=b?c[b]:void 0}}ko.mapping={};var n="__ko_mapping__",p=ko.dependentObservable,E=0,C,A,u={include:["_destroy"],ignore:[],
copy:[]},f=u;ko.mapping.isMapped=function(a){return(a=ko.utils.unwrapObservable(a))&&a[n]};ko.mapping.fromJS=function(a){if(0==arguments.length)throw Error("When calling ko.fromJS, pass the object you want to convert.");window.setTimeout(function(){E=0},0);E++||(C=[],A=new I);var c,b;2==arguments.length&&(arguments[1][n]?b=arguments[1]:c=arguments[1]);3==arguments.length&&(c=arguments[1],b=arguments[2]);b&&(c=s(c,b[n]));c=h(c);var d=z(b,a,c);b&&(d=b);--E||window.setTimeout(function(){ko.utils.arrayForEach(C,
function(a){a&&a()})},0);d[n]=s(d[n],c);return d};ko.mapping.fromJSON=function(a){var c=ko.utils.parseJson(a);arguments[0]=c;return ko.mapping.fromJS.apply(this,arguments)};ko.mapping.updateFromJS=function(){throw Error("ko.mapping.updateFromJS, use ko.mapping.fromJS instead. Please note that the order of parameters is different!");};ko.mapping.updateFromJSON=function(){throw Error("ko.mapping.updateFromJSON, use ko.mapping.fromJSON instead. Please note that the order of parameters is different!");
};ko.mapping.toJS=function(a,c){f||ko.mapping.resetDefaultOptions();if(0==arguments.length)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");if(!(f.ignore instanceof Array))throw Error("ko.mapping.defaultOptions().ignore should be an array.");if(!(f.include instanceof Array))throw Error("ko.mapping.defaultOptions().include should be an array.");if(!(f.copy instanceof Array))throw Error("ko.mapping.defaultOptions().copy should be an array.");c=h(c,a[n]);return ko.mapping.visitModel(a,
function(a){return ko.utils.unwrapObservable(a)},c)};ko.mapping.toJSON=function(a,c){var b=ko.mapping.toJS(a,c);return ko.utils.stringifyJson(b)};ko.mapping.defaultOptions=function(){if(0<arguments.length)f=arguments[0];else return f};ko.mapping.resetDefaultOptions=function(){f={include:u.include.slice(0),ignore:u.ignore.slice(0),copy:u.copy.slice(0)}};ko.mapping.getType=function(a){return a&&"object"===typeof a&&a.constructor==(new Date).constructor?"date":typeof a};ko.mapping.visitModel=function(a,
c,b){b=b||{};b.visitedObjects=b.visitedObjects||new I;b.parentName||(b=h(b));var d,g=ko.utils.unwrapObservable(a);if(D(g))c(a,b.parentName),d=g instanceof Array?[]:{};else return c(a,b.parentName);b.visitedObjects.save(a,d);var f=b.parentName;G(g,function(a){var e=b,k=g[n];k&&(e=h(k,b));if(!(e.ignore&&-1!=ko.utils.arrayIndexOf(e.ignore,a))){var k=g[a],j=b,l=f||"";g instanceof Array?f&&(l+="["+a+"]"):(f&&(l+="."),l+=a);j.parentName=l;if(!(-1===ko.utils.arrayIndexOf(e.copy,a)&&-1===ko.utils.arrayIndexOf(e.include,
a)&&g[n]&&g[n].mappedProperties&&!g[n].mappedProperties[a]&&!(g instanceof Array)))switch(ko.mapping.getType(ko.utils.unwrapObservable(k))){case "object":case "undefined":e=b.visitedObjects.get(k);d[a]="undefined"!==ko.mapping.getType(e)?e:ko.mapping.visitModel(k,c,b);break;default:d[a]=c(k,b.parentName)}}});return d};ko.exportSymbol("ko.mapping",ko.mapping);ko.exportSymbol("ko.mapping.fromJS",ko.mapping.fromJS);ko.exportSymbol("ko.mapping.fromJSON",ko.mapping.fromJSON);ko.exportSymbol("ko.mapping.isMapped",
ko.mapping.isMapped);ko.exportSymbol("ko.mapping.defaultOptions",ko.mapping.defaultOptions);ko.exportSymbol("ko.mapping.toJS",ko.mapping.toJS);ko.exportSymbol("ko.mapping.toJSON",ko.mapping.toJSON);ko.exportSymbol("ko.mapping.updateFromJS",ko.mapping.updateFromJS);ko.exportSymbol("ko.mapping.updateFromJSON",ko.mapping.updateFromJSON);ko.exportSymbol("ko.mapping.visitModel",ko.mapping.visitModel)})();
